# 🚨 Error Handling JavaScript dengan Fetch API

> **Panduan lengkap menangani error dalam JavaScript dengan implementasi pada Movie Search App menggunakan OMDB API**

---

## 📋 Daftar Isi

- [🚨 Error Handling JavaScript dengan Fetch API](#-error-handling-javascript-dengan-fetch-api)
  - [📋 Daftar Isi](#-daftar-isi)
  - [🎯 Overview](#-overview)
  - [📚 Konsep Dasar Error Handling](#-konsep-dasar-error-handling)
    - [🔄 Error Handling dengan Promise](#-error-handling-dengan-promise)
    - [⚡ Error Handling dengan Async/Await](#-error-handling-dengan-asyncawait)
  - [🔍 Problem yang Dihadapi](#-problem-yang-dihadapi)
  - [📝 Langkah-Langkah Implementation](#-langkah-langkah-implementation)
    - [1️⃣ Basic Error Handling dengan Try/Catch](#1️⃣-basic-error-handling-dengan-trycatch)
    - [2️⃣ Memahami Batasan Catch pada Fetch](#2️⃣-memahami-batasan-catch-pada-fetch)
    - [3️⃣ Investigasi Response Object](#3️⃣-investigasi-response-object)
    - [4️⃣ Implementasi Pengecekan response.ok (Attempt 1)](#4️⃣-implementasi-pengecekan-responseok-attempt-1)
    - [5️⃣ Perbaikan Error Handling HTTP](#5️⃣-perbaikan-error-handling-http)
    - [6️⃣ Investigasi Error API Spesifik](#6️⃣-investigasi-error-api-spesifik)
    - [7️⃣ Implementasi Error Handling API Response](#7️⃣-implementasi-error-handling-api-response)
    - [8️⃣ Error Display ke User](#8️⃣-error-display-ke-user)
  - [🏁 Code Final Lengkap](#-code-final-lengkap)
  - [✅ Tingkatan Error Handling yang Tercapai](#-tingkatan-error-handling-yang-tercapai)
  - [🔧 Cara Menjalankan Project](#-cara-menjalankan-project)

---

## 🎯 Overview

Dokumentasi ini membahas cara menangani error dalam JavaScript, khususnya saat menggunakan Fetch API untuk mengambil data dari server. Kita akan belajar bagaimana menangani berbagai jenis error mulai dari network error, HTTP status error, hingga API-specific error menggunakan aplikasi pencarian film sebagai studi kasus.

## 🗂️ Struktur File Project

```
project/
├── index.html          # File HTML utama
├── 09-agustus-2025.js  # File JavaScript
└── README.md          # Dokumentasi ini
```

## 📄 File HTML (index.html)

```html
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Handling Error</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    />
  </head>
  <body>
    <div class="container">
      <div class="row mt-5">
        <div class="col">
          <h1>Ahmad Movie DB</h1>
        </div>
      </div>

      <div class="row">
        <div class="col-md-8">
          <div class="input-group mb-3">
            <input
              type="text"
              class="form-control input-keyword"
              placeholder="Search Movie ..."
            />
            <button
              class="btn btn-primary search-button"
              type="button"
              id="button-addon2"
            >
              Search
            </button>
          </div>
        </div>
      </div>

      <div class="row movie-container"></div>
    </div>

    <!-- Awal Modal -->
    <div class="modal fade" id="movieDetailModal">
      <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h1 class="modal-title fs-5" id="movieDetailModal">Modal title</h1>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body"></div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Close
            </button>
          </div>
        </div>
      </div>
    </div>
    <!-- Akhir Modal -->

    <!-- import js bootsrap -->
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
      crossorigin="anonymous"
    ></script>
    <script src="./09-agustus-2025.js"></script>
  </body>
</html>
```

## 📄 Code Awal Sebelum Error Handling

Sebelum kita implementasi error handling, mari lihat code awal yang belum menangani error:

```javascript
// MENGGUNAKAN FETCH
const searchButton = document.querySelector(".search-button");
const movieContainer = document.querySelector(".movie-container");
const inputKeyword = document.querySelector(".input-keyword");
const modalDetailButton = document.querySelectorAll(".modal-detail-button");
const modalBody = document.querySelector(".modal-body");

searchButton.addEventListener("click", async function () {
  const movies = await getMovies(inputKeyword.value);
  // console.log(movies);
  updateUI(movies);
});

// event binding
document.addEventListener("click", async (e) => {
  if (e.target.classList.contains("modal-detail-button")) {
    const imdbID = e.target.dataset.imdbid;
    const movieDetail = await getDetailMovie(imdbID);
    // console.log(movies);
    updateUIDetail(movieDetail);
  }
});

// mengambil movies
function getMovies(keyword) {
  return fetch("http://www.omdbapi.com/?apikey=b2a155c4&s=" + keyword)
    .then((response) => response.json())
    .then((response) => response.Search);
}

// update UI movies
function updateUI(movies) {
  let cards = "";
  movies.forEach((movie) => {
    cards += showCards(movie);
  });
  movieContainer.innerHTML = cards;
}

// mengambil data detail movie
function getDetailMovie(id) {
  return fetch("http://www.omdbapi.com/?apikey=b2a155c4&i=" + id)
    .then((response) => response.json())
    .then((response) => response);
}

// update detail movie
function updateUIDetail(m) {
  const movieDetail = showMovieDetail(m);
  modalBody.innerHTML = movieDetail;
}

// menampung cards
function showCards(m) {
  return `<div class="col-md-4 my-5">
              <div class="card">
                <img src="${m.Poster}" class="card-img-top" />
                <div class="card-body">
                  <h5 class="card-title">${m.Title}</h5>
                  <h6 class="card-subtitle mb-2 text-body-secondary">${m.Year}</h6>
                  <a href="#" class="btn btn-primary modal-detail-button" data-bs-toggle="modal" data-bs-target="#movieDetailModal" data-imdbid="${m.imdbID}">Show Details</a>
                </div>
              </div>
            </div>`;
}

// menampung movie detail
function showMovieDetail(m) {
  return `<div class="container-fluid">
              <div class="row">
                <div class="col-md-3">
                  <img src="${m.Poster}" alt="" class="img-fluid" />
                </div>
                <div class="col-md">
                  <ul class="list-group">
                    <li class="list-group-item"><h4>${m.Title} (${m.Year})</h4></li>
                    <li class="list-group-item">
                      <strong>Director : </strong> ${m.Director}
                    </li>
                    <li class="list-group-item">
                      <strong>Actors : </strong> ${m.Actors}
                    </li>
                    <li class="list-group-item">
                      <strong>Writer : </strong> ${m.Writer}
                    </li>
                    <li class="list-group-item">
                      <strong>Plot : </strong> <br />
                    ${m.Plot}
                    </li>
                  </ul>
                </div>
              </div>
            </div>`;
}
```

**⚠️ Masalah pada code di atas:**
- Tidak ada penanganan error sama sekali
- Jika input kosong atau movie tidak ditemukan, aplikasi akan crash
- Error dari network atau API tidak tertangani
- User tidak mendapat feedback ketika terjadi error

---

## 📚 Konsep Dasar Error Handling

### 🔄 Error Handling dengan Promise

Promise menggunakan `.then()` untuk menangani resolve (berhasil) dan `.catch()` untuk menangani reject (gagal).

```javascript
// Error Handling : Promise 
// .then() -> jika resolve (berhasil)
// .catch() -> jika reject (gagal)

const cobaPromise = () => {
  return new Promise((resolve, reject) => {
    const waktu = 3000;
    if (waktu < 5000) {
      setTimeout(() => {
        resolve('selesai');
      }, waktu);
    } else {
      reject('kelamaan');
    }
  });
};

const coba = cobaPromise();
coba.then(() => console.log(coba)).catch(() => console.log(coba));
```

**Output:**
```
Promise {<fulfilled>: 'selesai'}
```

### ⚡ Error Handling dengan Async/Await

Async/Await menggunakan `try` untuk menangani resolve (berhasil) dan `catch()` untuk menangani reject (gagal).

```javascript
// Error Handling : Async Await
// try -> jika resolve (berhasil)
// catch() -> jika reject (gagal)

const cobaPromise = () => {
  return new Promise((resolve, reject) => {
    const waktu = 3000;
    if (waktu < 5000) {
      setTimeout(() => {
        resolve('selesai');
      }, waktu);
    } else {
      reject('kelamaan');
    }
  });
};

const cobaAsync = async () => {
  try {
    const coba = await cobaPromise();
    console.log(coba);
  } catch (error) {
    console.error(error);
  }
};

cobaAsync();
```

**Output:**
```
selesai
```

---

## 🔍 Problem yang Dihadapi

**❓ Gimana handling error pada fetch() ?**

Karena fetch() adalah API dari JavaScript yang kita tidak tahu apa yang ada di dalam method reject dari fetch(), jadi kita akan mencoba handling error pada fetch.

**🚫 Masalah yang terjadi:**
- Pada code sebelumnya hanya menangani saat berhasil saja
- Jika kita mengetik nama sembarang pada kolom pencarian movie, errornya akan muncul di browser
- Error tidak tertangani dengan baik

---

## 📝 Langkah-Langkah Implementation

### 1️⃣ Basic Error Handling dengan Try/Catch

**Code awal tanpa error handling:**
```javascript
searchButton.addEventListener("click", async function () {
  const movies = await getMovies(inputKeyword.value);
  // console.log(movies);
  updateUI(movies);
});
```

**⚠️ Masalah:**
- Jika `getMovies()` menghasilkan error, aplikasi akan crash
- User tidak mendapat feedback apa-apa
- Error muncul di console browser tanpa penanganan

**➡️ Implementasi try/catch:**
```javascript
searchButton.addEventListener('click', async function () {
  try {
    const inputKeyword = document.querySelector('.input-keyword');
    const movies = await getMovies(inputKeyword.value);
    console.log(movies);
    updateUI(movies);
  } catch (error) {
    console.log(error);
  }
});
```

**Output:**
```
✅ Error sudah ditangkap oleh catch(), tidak lagi ditangkap oleh browser
```

---

### 2️⃣ Memahami Batasan Catch pada Fetch

**🧪 Test case:** Apa saja yang bisa ditangkap oleh catch()?

**Contoh - URL salah:**
```javascript
// Misal urlnya salah
fetch('http://www.salahurl.com/?apikey=b2a155c4&s=batman')
```

**Output:**
```
TypeError: Failed to fetch
```

**📋 Kesimpulan penting:**
- Error pada fetch, yang ditangkap hanya error pada networknya
- Misal saat kita mengosongkan movie saat diklik maupun menulis sembarang nama movie, errornya dari browser (karena ada fungsi updateUI, kalau dinon aktifkan dulu, errornya tidak muncul)
- **catch() pada fetch hanya menangkap saat error pada networknya saja**

---

### 3️⃣ Investigasi Response Object

**❗ Problem:** Untuk menangani hal itu, kita harus tangani manual pada saat fetchnya berhasil mengambil data dari API. Misal kita membuat kesalahan pada key maka hasilnya sebagai berikut.

**Code investigasi:**
```javascript
// mengambil movie
function getMovies(keyword) {
  return fetch('http://www.omdbapi.com/?apikey=b2a155c4&s=' + keyword)
    .then((response) => {
      console.log(response); // Ubah code untuk melihat dari response apa saja yang muncul 
    })
    .then((response) => response.Search);
}
```

**📊 Hasil pengamatan:**

**Kondisi 1 - Input kosong, key dan url benar:**
```javascript
Response {
  status: 200,
  ok: true,
  // ... other properties
}
```

**Kondisi 2 - Key dan URL benar:**
```
ok: true
```

**Kondisi 3 - Key salah:**
```
ok: false
```

**✨ Kesimpulan:** Jadi kita bisa mengambil `response.ok`, `response.status`, `response.statusText`

---

### 4️⃣ Implementasi Pengecekan response.ok (Attempt 1)

```javascript
// mengambil movie
function getMovies(keyword) {
  return fetch('http://www.omdbapi.com/?apikey=2a155c4&s=' + keyword)  // Key sengaja salah
    .then((response) => {
      if (!response.ok) {
        throw Error(response.status);
      }
    })
    .then((response) => response.Search);
}
```

**Output:**
```
Error: 401
```

---

### 5️⃣ Perbaikan Error Handling HTTP

```javascript
// mengambil movie
function getMovies(keyword) {
  return fetch('http://www.omdbapi.com/?apikey=b2a155c4&s=' + keyword)
    .then((response) => {
      if (!response.ok) {
        throw new Error(response.statusText);
      }
      return response.json();
    })
    .then((response) => response.Search);
}
```

**🔍 Penjelasan detail:**
```javascript
// jika response.ok bernilai false (! berarti NOT, nilai awal dari ok adalah true)
if (!response.ok) {
// keyword throw -> untuk mengalihkan error ke class Error punya dari javascript
// new Error -> untuk bisa mengakses class Error dari javascript dan errornya berisi response.statusText
        throw Error(response.statusText);
      }

// jika sudah dicek keynya sudah benar, maka return hasil dari response yang sudah diberi method json()
      return response.json();
```

**Output:**
```
Error: Unauthorized (jika key salah)
✅ Data berhasil diambil (jika key benar)
```

---

### 6️⃣ Investigasi Error API Spesifik

**❗ Problem:** Selanjutnya menangani error saat hanya memasukkan nilai kosong atau nama movie sembarang saat mengklik tombol search.

**Code investigasi:**
```javascript
// mengambil movie
function getMovies(keyword) {
  return fetch('http://www.omdbapi.com/?apikey=b2a155c4&s=' + keyword)
    .then((response) => {
      if (!response.ok) {
        throw new Error(response.statusText);
      }
      return response.json();
    })
    .then((response) => {
      console.log(response); // untuk melihat dulu apa saja respon yang ditunjukkan 
    });
}
```

**📊 Hasil pengamatan:**

**Kondisi 1 - Input kosong:**
```javascript
{
  Response: "False",
  Error: "Incorrect IMDb ID."
}
```

**Kondisi 2 - Menulis sembarang judul:**
```javascript
{
  Response: "False", 
  Error: "Movie not found!"
}
```

---

### 7️⃣ Implementasi Error Handling API Response

```javascript
// mengambil movie
function getMovies(keyword) {
  return fetch('http://www.omdbapi.com/?apikey=b2a155c4&s=' + keyword)
    .then((response) => {
      if (!response.ok) {
        throw new Error(response.statusText);
      }
      return response.json();
    })
    .then((response) => {
      if (response.Response === 'False') {
        throw new Error(response.Error);
      }
      return response.Search;
    });
}
```

**🔍 Penjelasan detail:**
```javascript
// jika berhasil lolos dari pengecekan key maka dilanjutkan proses pengecekan kosong atau tidak sesuainya inputan movie sebelum klik tombol search
.then((response) => {
// jika response.Response bernilai false
      if (response.Response === 'False') {
// maka di lempar ke class Error milik javascript yang berisi nilai dari response.Error
        throw new Error(response.Error);
      }

// jika sudah lolos pengecekan baru di return hasilnya 
      return response.Search;
    })
```

**Output:**
```
Error: Incorrect IMDb ID. (jika input kosong)
Error: Movie not found! (jika movie tidak ditemukan)
✅ Array of movies (jika berhasil)
```

---

### 8️⃣ Error Display ke User

**❗ Problem:** Code diatas hanya kelihatan di console, misal ingin errornya nampak di browser bisa memanfaatkan alert, seperti code di bawah.

```javascript
searchButton.addEventListener('click', async function () {
  try {
    const inputKeyword = document.querySelector('.input-keyword');
    const movies = await getMovies(inputKeyword.value);
    console.log(movies);
    updateUI(movies);
  } catch (error) {
    alert(error);
  }
});
```

**🔍 Penjelasan:**
```javascript
// catch berisi parameter error yang ditangkap
catch (error) {
// agar errornya kelihatan di browser berbentuk alert yang menunjukkan pesannya
    alert(error);
  }
```

**📱 Hasil akhir:**

**Test 1 - Input kosong mengklik tombol search:**
```
Alert popup: "Error: Incorrect IMDb ID."
```

**Test 2 - Menulis movie sembarangan:**
```
Alert popup: "Error: Movie not found!"
```

---

## 🏁 Code Final Lengkap

```javascript
const searchButton = document.querySelector('.search-button');

searchButton.addEventListener('click', async function () {
  try {
    const inputKeyword = document.querySelector('.input-keyword');
    const movies = await getMovies(inputKeyword.value);
    console.log(movies);
    updateUI(movies);
  } catch (error) {
    alert(error);
  }
});

// mengambil movie
function getMovies(keyword) {
  return fetch('http://www.omdbapi.com/?apikey=b2a155c4&s=' + keyword)
    .then((response) => {
      if (!response.ok) {
        throw new Error(response.statusText);
      }
      return response.json();
    })
    .then((response) => {
      if (response.Response === 'False') {
        throw new Error(response.Error);
      }
      return response.Search;
    });
}

// mengupdate UI
function updateUI(movies) {
  let cards = '';
  movies.forEach((m) => (cards += showCards(m)));
  const movieContainer = document.querySelector('.movie-container');
  movieContainer.innerHTML = cards;
}

// event binding
document.addEventListener('click', async function (e) {
  if (e.target.classList.contains('modal-detail-button')) {
    const imdbid = e.target.dataset.imdbid;
    const movieDetail = await getMoviedetail(imdbid);
    updateUIDetail(movieDetail);
  }
});

// mengambil data detail movie
function getMoviedetail(imdbid) {
  return fetch('http://www.omdbapi.com/?apikey=b2a155c4&i=' + imdbid)
    .then((response) => response.json())
    .then((m) => m);
}

// mengupdate ui detail movie
function updateUIDetail(m) {
  const movieDetail = showMovieDetail(m);
  const modalBody = document.querySelector('.modal-body');
  modalBody.innerHTML = movieDetail;
}

// menampung cards
function showCards(m) {
  return `<div class="col-md-4 my-5">
              <div class="card">
                <img src="${m.Poster}" class="card-img-top" />
                <div class="card-body">
                  <h5 class="card-title">${m.Title}</h5>
                  <h6 class="card-subtitle mb-2 text-body-secondary">${m.Year}</h6>
                  <a href="#" class="btn btn-primary modal-detail-button" data-bs-toggle="modal" data-bs-target="#movieDetailModal" data-imdbid="${m.imdbID}">Show Details</a>
                </div>
              </div>
            </div>`;
}

// menampung movie detail
function showMovieDetail(m) {
  return `<div class="container-fluid">
              <div class="row">
                <div class="col-md-3">
                  <img src="${m.Poster}" alt="" class="img-fluid" />
                </div>
                <div class="col-md">
                  <ul class="list-group">
                    <li class="list-group-item"><h4>${m.Title} (${m.Year})</h4></li>
                    <li class="list-group-item">
                      <strong>Director : </strong> ${m.Director}
                    </li>
                    <li class="list-group-item">
                      <strong>Actors : </strong> ${m.Actors}
                    </li>
                    <li class="list-group-item">
                      <strong>Writer : </strong> ${m.Writer}
                    </li>
                    <li class="list-group-item">
                      <strong>Plot : </strong> <br />
                    ${m.Plot}
                    </li>
                  </ul>
                </div>
              </div>
            </div>`;
}
```

## 📊 Perbandingan Code: Sebelum vs Sesudah Error Handling

### **❌ Code Sebelum (Tanpa Error Handling)**

```javascript
// ⚠️ PROBLEM: Tidak ada penanganan error
searchButton.addEventListener("click", async function () {
  const movies = await getMovies(inputKeyword.value);
  updateUI(movies);
});

// ⚠️ PROBLEM: Tidak mengecek response status
function getMovies(keyword) {
  return fetch("http://www.omdbapi.com/?apikey=b2a155c4&s=" + keyword)
    .then((response) => response.json())
    .then((response) => response.Search);
}
```

**Masalah yang terjadi:**
- ❌ Aplikasi crash jika input kosong
- ❌ Aplikasi crash jika movie tidak ditemukan  
- ❌ Tidak ada feedback ke user
- ❌ Error network tidak tertangani

### **✅ Code Sesudah (Dengan Error Handling)**

```javascript
// ✅ SOLUTION: Menggunakan try/catch untuk menangani error
searchButton.addEventListener('click', async function () {
  try {
    const inputKeyword = document.querySelector('.input-keyword');
    const movies = await getMovies(inputKeyword.value);
    updateUI(movies);
  } catch (error) {
    alert(error); // ✅ User mendapat feedback
  }
});

// ✅ SOLUTION: Menangani berbagai jenis error
function getMovies(keyword) {
  return fetch('http://www.omdbapi.com/?apikey=b2a155c4&s=' + keyword)
    .then((response) => {
      // ✅ Mengecek HTTP status
      if (!response.ok) {
        throw new Error(response.statusText);
      }
      return response.json();
    })
    .then((response) => {
      // ✅ Mengecek API response
      if (response.Response === 'False') {
        throw new Error(response.Error);
      }
      return response.Search;
    });
}
```

**Keuntungan yang didapat:**
- ✅ Aplikasi tidak crash
- ✅ User mendapat feedback yang jelas
- ✅ Error tertangani dengan baik
- ✅ User experience meningkat

---

## ✅ Tingkatan Error Handling yang Tercapai

| Level | Jenis Error | Cara Penanganan | Status |
|-------|-------------|-----------------|---------|
| 1️⃣ | **Network Error** | Ditangkap otomatis oleh `catch()` | ✅ |
| 2️⃣ | **HTTP Status Error** | Dicek manual dengan `response.ok` | ✅ |
| 3️⃣ | **API Specific Error** | Dicek manual dengan `response.Response === 'False'` | ✅ |

**🎯 Hasil Akhir:**
- ✅ Network error tertangani
- ✅ HTTP status error tertangani  
- ✅ API specific error tertangani
- ✅ User mendapat feedback yang jelas
- ✅ Aplikasi tidak crash

---

## 🔧 Cara Menjalankan Project

1. **Clone/Download** project ini
2. **Buat file HTML** dengan struktur yang sesuai
3. **Include Bootstrap** untuk styling
4. **Masukkan JavaScript** ke dalam file terpisah
5. **Buka di browser** dan test berbagai skenario error

**🔗 API yang digunakan:** [OMDB API](http://www.omdbapi.com/)

---

> 💡 **Tips:** Selalu tangani error dengan baik untuk memberikan user experience yang optimal dan mencegah aplikasi crash!

---

**📝 Dokumentasi ini dibuat untuk pembelajaran Error Handling JavaScript dengan implementasi nyata pada aplikasi Movie Search.**
