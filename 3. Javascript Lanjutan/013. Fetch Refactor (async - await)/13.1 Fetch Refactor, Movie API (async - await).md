# üé¨ Movie API dengan Async/Await - Refactoring Documentation

> **Dokumentasi lengkap untuk refactoring kode Movie API menggunakan async/await untuk membuat kode lebih mudah dibaca dan dipelihara**

---

## üìã Daftar Isi

- [üéØ Overview](#-overview)
- [üîß Setup Awal](#-setup-awal)
- [üìÅ Struktur Project](#-struktur-project)
- [üöÄ Implementasi](#-implementasi)
  - [1. Setup Event Listener](#1-setup-event-listener)
  - [2. Membuat Function getMovies()](#2-membuat-function-getmovies)
  - [3. Async/Await Implementation](#3-asyncawait-implementation)
  - [4. Update UI Function](#4-update-ui-function)
  - [5. Event Binding untuk Detail](#5-event-binding-untuk-detail)
  - [6. Movie Detail Function](#6-movie-detail-function)
- [üéØ Kode Final](#-kode-final)
- [üîÑ Perbandingan Sebelum dan Sesudah](#-perbandingan-sebelum-dan-sesudah)
- [‚ú® Kesimpulan](#-kesimpulan)

---

## üéØ Overview

Proyek ini menunjukkan cara melakukan **refactoring** kode JavaScript dari menggunakan Fetch API dengan Promise chains menjadi **async/await** yang lebih mudah dibaca dan dipelihara. 

**Tujuan Refactoring:**
- ‚úÖ Membuat kode lebih terstruktur dan mudah dibaca
- ‚úÖ Memisahkan logic ke dalam fungsi-fungsi terpisah
- ‚úÖ Implementasi async/await untuk handling asynchronous operations
- ‚úÖ Implementasi event binding untuk dynamic content

---

## üîß Setup Awal

### HTML Structure
```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Async Await Refactoring</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container">
        <div class="row mt-5">
            <div class="col">
                <h1>Ahmad Movie DB</h1>
            </div>
        </div>
        
        <div class="row">
            <div class="col-md-8">
                <div class="input-group mb-3">
                    <input type="text" class="form-control input-keyword" placeholder="Search Movie ...">
                    <button class="btn btn-primary search-button" type="button">Search</button>
                </div>
            </div>
        </div>
        
        <div class="row movie-container"></div>
    </div>
    
    <!-- Modal untuk detail movie -->
    <div class="modal fade" id="movieDetailModal">
        <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title fs-5">Movie Details</h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body"></div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="./script.js"></script>
</body>
</html>
```

**Output:** Halaman web dengan form pencarian movie dan modal untuk menampilkan detail

---

## üìÅ Struktur Project

```
movie-app/
‚îú‚îÄ‚îÄ index.html
‚îú‚îÄ‚îÄ script.js
‚îî‚îÄ‚îÄ README.md
```

---

## üöÄ Implementasi

### 1. Setup Event Listener

**Langkah pertama:** Mengambil elemen tombol search dan menambahkan event listener

```javascript
const searchButton = document.querySelector('.search-button');

searchButton.addEventListener('click', function () {
    const inputKeyword = document.querySelector('.input-keyword');
    console.log(inputKeyword.value);
});
```

**Output:** Ketika tombol search diklik, akan menampilkan nilai yang diketik user di console

---

### 2. Membuat Function getMovies()

**Tujuan:** Memisahkan logic fetch API ke dalam fungsi terpisah

```javascript
// mengambil movies
function getMovies(keyword) {
    return fetch('http://www.omdbapi.com/?apikey=b2a155c4&s=' + keyword)
        .then((response) => response.json())
        .then((response) => response.Search);
}
```

**Output:** Function yang mengembalikan Promise dengan data array movies dari API

---

### 3. Async/Await Implementation

**Masalah:** Ketika menggunakan `getMovies()` tanpa async/await, hasilnya `Promise pending`

```javascript
// ‚ùå SALAH - Hasil Promise pending
searchButton.addEventListener('click', function () {
    const inputKeyword = document.querySelector('.input-keyword');
    const movies = getMovies(inputKeyword.value);
    console.log(movies); // Promise pending
});
```

**Solusi:** Menggunakan async/await

```javascript
// ‚úÖ BENAR - Menggunakan async/await
searchButton.addEventListener('click', async function () {
    const inputKeyword = document.querySelector('.input-keyword');
    const movies = await getMovies(inputKeyword.value);
    console.log(movies); // Array movies
    updateUI(movies);
});
```

**Output:** Data movies berhasil diambil dan ditampilkan sebagai array objects

---

### 4. Update UI Function

**Fungsi untuk memperbarui tampilan dengan data movies**

```javascript
// update UI movies
function updateUI(movies) {
    let cards = '';
    movies.forEach((m) => (cards += showCards(m)));
    
    const movieContainer = document.querySelector('.movie-container');
    movieContainer.innerHTML = cards;
}

// menampung cards
function showCards(m) {
    return `<div class="col-md-4 my-5">
                <div class="card">
                    <img src="${m.Poster}" class="card-img-top" />
                    <div class="card-body">
                        <h5 class="card-title">${m.Title}</h5>
                        <h6 class="card-subtitle mb-2 text-body-secondary">${m.Year}</h6>
                        <a href="#" class="btn btn-primary modal-detail-button" 
                           data-bs-toggle="modal" data-bs-target="#movieDetailModal" 
                           data-imdbid="${m.imdbID}">Show Details</a>
                    </div>
                </div>
            </div>`;
}
```

**Output:** Tampilan grid cards berisi poster movie, judul, tahun, dan tombol detail

---

### 5. Event Binding untuk Detail

**Masalah:** Tombol detail movie tidak terdeteksi karena dibuat secara dinamis

```javascript
// ‚ùå SALAH - Hasilnya null karena elemen belum ada saat page load
const movieDetailBtn = document.querySelector('.modal-detail-button');
console.log(movieDetailBtn); // null
```

**Solusi:** Menggunakan Event Binding pada document

```javascript
// ‚úÖ BENAR - Event binding untuk dynamic content
document.addEventListener('click', async function (e) {
    if (e.target.classList.contains('modal-detail-button')) {
        const imdbid = e.target.dataset.imdbid;
        console.log(imdbid); // ID movie yang diklik
        
        const movieDetail = await getMovieDetail(imdbid);
        updateUIDetail(movieDetail);
    }
});
```

**Output:** Setiap klik tombol detail akan menampilkan IMDb ID yang berbeda sesuai movie yang dipilih

---

### 6. Movie Detail Function

**Fungsi untuk mengambil dan menampilkan detail movie**

```javascript
// mengambil detail movie
function getMovieDetail(imdbid) {
    return fetch('http://www.omdbapi.com/?apikey=b2a155c4&i=' + imdbid)
        .then((response) => response.json())
        .then((m) => m);
}

// mengupdate ui detail movie
function updateUIDetail(m) {
    const movieDetail = showMovieDetail(m);
    const modalBody = document.querySelector('.modal-body');
    modalBody.innerHTML = movieDetail;
}

// menampung movie detail
function showMovieDetail(m) {
    return `<div class="container-fluid">
                <div class="row">
                    <div class="col-md-3">
                        <img src="${m.Poster}" alt="" class="img-fluid" />
                    </div>
                    <div class="col-md">
                        <ul class="list-group">
                            <li class="list-group-item"><h4>${m.Title} (${m.Year})</h4></li>
                            <li class="list-group-item"><strong>Director:</strong> ${m.Director}</li>
                            <li class="list-group-item"><strong>Actors:</strong> ${m.Actors}</li>
                            <li class="list-group-item"><strong>Writer:</strong> ${m.Writer}</li>
                            <li class="list-group-item">
                                <strong>Plot:</strong><br>${m.Plot}
                            </li>
                        </ul>
                    </div>
                </div>
            </div>`;
}
```

**Output:** Modal popup dengan detail lengkap movie (poster, director, actors, writer, plot)

---

## üéØ Kode Final

```javascript
const searchButton = document.querySelector('.search-button');

// Event listener untuk tombol search
searchButton.addEventListener('click', async function () {
    const inputKeyword = document.querySelector('.input-keyword');
    const movies = await getMovies(inputKeyword.value);
    updateUI(movies);
});

// Event binding untuk tombol detail
document.addEventListener('click', async function (e) {
    if (e.target.classList.contains('modal-detail-button')) {
        const imdbid = e.target.dataset.imdbid;
        const movieDetail = await getMovieDetail(imdbid);
        updateUIDetail(movieDetail);
    }
});

// mengambil movie dari API
function getMovies(keyword) {
    return fetch('http://www.omdbapi.com/?apikey=b2a155c4&s=' + keyword)
        .then((response) => response.json())
        .then((response) => response.Search);
}

// mengupdate UI dengan data movies
function updateUI(movies) {
    let cards = '';
    movies.forEach((m) => (cards += showCards(m)));
    
    const movieContainer = document.querySelector('.movie-container');
    movieContainer.innerHTML = cards;
}

// mengambil detail movie dari API
function getMovieDetail(imdbid) {
    return fetch('http://www.omdbapi.com/?apikey=b2a155c4&i=' + imdbid)
        .then((response) => response.json())
        .then((m) => m);
}

// mengupdate UI detail movie
function updateUIDetail(m) {
    const movieDetail = showMovieDetail(m);
    const modalBody = document.querySelector('.modal-body');
    modalBody.innerHTML = movieDetail;
}

// template untuk movie cards
function showCards(m) {
    return `<div class="col-md-4 my-5">
                <div class="card">
                    <img src="${m.Poster}" class="card-img-top" />
                    <div class="card-body">
                        <h5 class="card-title">${m.Title}</h5>
                        <h6 class="card-subtitle mb-2 text-body-secondary">${m.Year}</h6>
                        <a href="#" class="btn btn-primary modal-detail-button" 
                           data-bs-toggle="modal" data-bs-target="#movieDetailModal" 
                           data-imdbid="${m.imdbID}">Show Details</a>
                    </div>
                </div>
            </div>`;
}

// template untuk movie detail
function showMovieDetail(m) {
    return `<div class="container-fluid">
                <div class="row">
                    <div class="col-md-3">
                        <img src="${m.Poster}" alt="" class="img-fluid" />
                    </div>
                    <div class="col-md">
                        <ul class="list-group">
                            <li class="list-group-item"><h4>${m.Title} (${m.Year})</h4></li>
                            <li class="list-group-item"><strong>Director:</strong> ${m.Director}</li>
                            <li class="list-group-item"><strong>Actors:</strong> ${m.Actors}</li>
                            <li class="list-group-item"><strong>Writer:</strong> ${m.Writer}</li>
                            <li class="list-group-item">
                                <strong>Plot:</strong><br>${m.Plot}
                            </li>
                        </ul>
                    </div>
                </div>
            </div>`;
}
```

---

## üîÑ Perbandingan Sebelum dan Sesudah

### ‚ùå Sebelum Refactoring
```javascript
// Semua logic dalam satu event listener - sulit dibaca
searchButton.addEventListener('click', function () {
    const inputKeyword = document.querySelector('.input-keyword');
    
    fetch('http://www.omdbapi.com/?apikey=b2a155c4&s=' + inputKeyword.value)
        .then((response) => response.json())
        .then((response) => {
            const movies = response.Search;
            let cards = '';
            movies.forEach((m) => (cards += showCards(m)));
            const movieContainer = document.querySelector('.movie-container');
            movieContainer.innerHTML = cards;
            
            // Nested promises untuk detail - callback hell
            const modalDetailButton = document.querySelectorAll('.modal-detail-button');
            modalDetailButton.forEach((btn) => {
                btn.addEventListener('click', function () {
                    const imdbid = this.dataset.imdbid;
                    fetch('http://www.omdbapi.com/?apikey=b2a155c4&i=' + imdbid)
                        .then((response) => response.json())
                        .then((m) => {
                            const movieDetail = showMovieDetail(m);
                            const modalBody = document.querySelector('.modal-body');
                            modalBody.innerHTML = movieDetail;
                        });
                });
            });
        });
});
```

### ‚úÖ Sesudah Refactoring
```javascript
// Logic terpisah dalam fungsi-fungsi yang jelas
searchButton.addEventListener('click', async function () {
    const inputKeyword = document.querySelector('.input-keyword');
    const movies = await getMovies(inputKeyword.value);
    updateUI(movies);
});

// Event binding yang lebih robust
document.addEventListener('click', async function (e) {
    if (e.target.classList.contains('modal-detail-button')) {
        const imdbid = e.target.dataset.imdbid;
        const movieDetail = await getMovieDetail(imdbid);
        updateUIDetail(movieDetail);
    }
});
```

---

## ‚ú® Kesimpulan

### üéØ Keuntungan Refactoring:

1. **Readability**: Kode lebih mudah dibaca dan dipahami
2. **Maintainability**: Mudah untuk dimodifikasi dan dikembangkan
3. **Separation of Concerns**: Setiap fungsi memiliki tanggung jawab yang jelas
4. **Async/Await**: Lebih intuitif dibanding Promise chains
5. **Event Binding**: Menangani dynamic content dengan lebih baik
6. **Error Handling**: Lebih mudah untuk menambahkan error handling

### üöÄ Konsep Penting:

- **Async/Await**: Membuat asynchronous code terlihat seperti synchronous
- **Event Binding**: Menangani event pada elemen yang dibuat secara dinamis  
- **Function Abstraction**: Memisahkan logic ke dalam fungsi-fungsi terpisah
- **API Integration**: Menggunakan OMDB API untuk data movies

### üìö Next Steps:

- Tambahkan error handling untuk network failures
- Implementasi loading states
- Tambahkan search validation
- Implementasi caching untuk performa yang lebih baik

---

> **üí° Tips:** Selalu gunakan async/await untuk asynchronous operations yang lebih clean dan mudah di-debug dibandingkan dengan Promise chains!

---

**Created with ‚ù§Ô∏è for learning JavaScript Async/Await**
